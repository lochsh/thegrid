<!doctype html>
<head>
  <meta charset=UTF-8>
  <style type="text/css">
    #patterns { border: 1px solid; }
    td { border: 1px solid; }
  </style>
</head>
<body>
  <h1>TheÂ·Grid Control</h1>
  <table id=patterns>
  </table>
</body>
<script>
  function sendform() {
    var fd = new FormData(this.form);
    var xhr = new XMLHttpRequest();
    xhr.open('POST', this.form.action, true);
    xhr.send(fd);
    return false;
  };

  var req = new XMLHttpRequest();
  req.open("GET", "/api/list_patterns", true);
  req.send();
  req.onload = function() {
    var patterns = JSON.parse(this.responseText);
    var table = document.getElementById("patterns");
    for (pattern of patterns) {
      var row = table.insertRow(-1);
      var name = row.insertCell(0);
      name.innerHTML = pattern;
      var load = row.insertCell(1);
      var loadform = document.createElement("form");
      loadform.setAttribute("method", "post");
      loadform.setAttribute("action", "/api/load_pattern/" + pattern);
      var loadbtn = document.createElement("input");
      loadbtn.setAttribute("type", "submit");
      loadbtn.setAttribute("value", "load");
      loadbtn.onclick = sendform;
      loadform.appendChild(loadbtn);
      load.appendChild(loadform);
    }
  }
</script>
