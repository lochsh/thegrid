<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>The·Grid</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
        <meta property="og:site_name" content="The·Grid" />
            <meta property="og:type" content="website"/>
            <meta property="og:title" content="The·Grid"/>
            <meta property="og:url" content="http://www.thegrid.fish"/>
            <meta property="og:description" content="The·Grid"/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://www.thegrid.fish/theme/css/bootstrap.cyborg.min.css" type="text/css"/>
    <link href="http://www.thegrid.fish/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://www.thegrid.fish/theme/css/pygments/native.css" rel="stylesheet">
        <link href="http://www.thegrid.fish/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://www.thegrid.fish/theme/css/style.css" type="text/css"/>
    <link href="http://www.thegrid.fish/bodges.css" rel="stylesheet" />

        <link href="http://www.thegrid.fish/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="The·Grid ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://www.thegrid.fish/" class="navbar-brand">
The·Grid            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://www.thegrid.fish/pages/about.html">
                             About
                          </a></li>
                        <li >
                            <a href="http://www.thegrid.fish/category/blog.html">Blog</a>
                        </li>
                <script language="JavaScript" src="/quotes.js"></script>
                <li><p><script language="JavaScript">
                document.write(quote[pickquote])</script></p></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://www.thegrid.fish/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/05/welcome">Welcome</a></h2>
                <div class="summary"><p>The·Grid is an art/engineering installation to be displayed at <a href="http://www.emfcamp.org"><span class="caps">EMF</span>
2014</a>.  Visit the
<a href="http://www.thegrid.fish/pages/about.html">About</a> page for a quick overview of what we&#8217;re
doing, or read the build log below for progress updates and juicy&nbsp;details&#8230;</p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/08/04/wire-delivery">Wire&nbsp;Delivery</a></h2>
                <div class="summary"><p>Today we got the rest of the <span class="caps">PCB</span> components, the flight case that will house
the electronics, and the first 400m of field cable from <span class="caps">CPC</span>:</p>
<p><img alt="wire delivery" src="/images/wire_delivery.jpg" />
<img alt="wire spools" src="/images/wire_spools.jpg" />
<img alt="psus in flight case" src="/images/psus_in_case_mock.jpg" /></p>
<p>Looking good! We&#8217;ll get the rest of the PCBs soldered up over the next few days
and then all that&#8217;s left is a little mechanical work and a lot of careful&nbsp;software.</p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/16/leds-arrived">LEDs&nbsp;Arrived!</a></h2>
                <div class="summary"><p>The LEDs turned up! £300, 250m, 7500 LEDs, in one unassuming&nbsp;box:</p>
<p><img alt="LED parcel" src="/images/led_parcel.jpg" /></p>
<p>We opened it up, and sure enough, 50 individually bagged reels of 5m <span class="caps">LED</span>&nbsp;strip:</p>
<p><img alt="LED strips" src="/images/led_opened.jpg" /></p>
<p>Obviously we had to test all 50 to be sure they were in fine working order, so
we sat down and got to&nbsp;it.</p>
<p><img alt="LED testing" src="/images/led_testing.jpg" /></p>
<p>I&#8217;m happy to report that every <span class="caps">LED</span> functioned correctly.&nbsp;Hurray!</p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/16/yellow-pcb">Yellow <span class="caps">PCB</span></a></h2>
                <div class="summary"><p>I&#8217;m really excited about the PCBs, but don&#8217;t really have much to report.
They&#8217;re with fab house and should be manufactured by the beginning of next week
and with us by the end of next week.  Before they went to fab, I made a few
minor changes, mainly to increase clearance and track width.  This should make
the board pretty hard to get wrong, meaning we get a good&nbsp;yield.</p>
<p>Here are the updated gerbers, rendered by <a href="http://dirtypcbs.com/">Dirty PCBs</a>
in a rendition of their final yellow&nbsp;soldermask:</p>
<p><img alt="yellow pcbs" src="/images/pcb_yellow.png" /></p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/13/gerbils-away">Gerbils&nbsp;away!</a></h2>
                <div class="summary"><p>After a final slog, the <span class="caps">PCB</span> was routed and ready to go!  Less than 48 hours
from deciding to do a <span class="caps">PCB</span> to submitting Gerbers has got to be a&nbsp;record.</p>
<p>I&#8217;ll try to talk some more about some of the design choices when I&#8217;ve had more
sleep.  For now, here&#8217;s what it looks&nbsp;like:</p>
<p><img alt="Gerbils..." src="/images/gerbils.png" /></p>
<p>And now, their fate rests in the trustworthy hands of <a href="http://dirtypcbs.com/">Dirty
PCBs</a>&#8230;</p>
<p><img alt="Ruh roh" src="/images/yum_yum_pcbs.png" /></p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/13/testing-intensifies">Testing&nbsp;Intensifies</a></h2>
                <div class="summary"><p>Another busy day. Further software refinements led to a Tkinter-based sink to
make visualisation&nbsp;easier:</p>
<p><img alt="Tkinter GUI" src="/images/tkinter.png" /></p>
<p>I also stuck together a simple sink using pylibftdi in bitbang mode, which was
even easier than I expected. It generates the <span class="caps">DATA</span>, <span class="caps">SRCK</span> and <span class="caps">RCK</span> signals for
the shift registers using three pins on the <span class="caps">FTDI</span>.</p>
<p>Meanwhile David was busy finishing up the <span class="caps">PCB</span> design (more on that later).
Afterwards he stuck together the prototype electronics on a breadboard,
connected up the relays and two (of the eventual 49) <span class="caps">LED</span> strips and we tried
hooking it all up for the first&nbsp;time.</p>
<p><img alt="First Full Test" src="/images/first_full_test.jpg" />
<img alt="Full Test Unrolled" src="/images/full_test_unrolled.jpg" /></p>
<iframe width="420" height="315"
src="//www.youtube-nocookie.com/embed/3Ok0Z6Nax6U?rel=0" frameborder="0"
allowfullscreen></iframe>

<p>It all worked! Additionally the relays sounded great on one of the aluminium
poles. This is a very positive result and we&#8217;re now confident that the
electronics design, software design, and various other choices that led to this
moment were at least on the right track.  All that&#8217;s left is the actual PCBs,
the hard parts of the software (person tracking!) and a million other
tasks-to-do before <span class="caps">EMF</span>.</p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/12/control-software">Control&nbsp;Software</a></h2>
                <div class="summary"><p>Last night we started fleshing out the design for the control software. The
bulk of it will be written in Python, because we&#8217;re both familiar with the
language and it has good bindings to libFTDI and&nbsp;OpenCV.</p>
<p>First I sketched out an outline of the overall&nbsp;design:</p>
<p><img alt="paper planning" src="/images/software_plan.jpg" /></p>
<p>We have a central &#8216;Control&#8217; object which is responsible for tying everything
together, and externally we&#8217;ll use <a href="http://supervisord.org/">supervisord</a> to
start and manage it. It starts an <span class="caps">API</span> and Tracking process via multiprocessing,
and loads up all the Patterns and Sinks it knows about and waits for&nbsp;instructions.</p>
<p>The <span class="caps">HTTP</span> <span class="caps">API</span> is in a separate process and uses the wonderful
<a href="http://flask.pocoo.org/">Flask</a> library, with a Queue to pass commands back to
the Control process. The <span class="caps">API</span> receives (command, value) pairs from <span class="caps">HTTP</span> <span class="caps">POST</span>
requests, checks the authentication against the settings, then sends the
command on. Later we&#8217;ll probably extend this to also return data about the
current state of the system, for example which Patterns are&nbsp;available.</p>
<p>The Tracking process will use <a href="http://opencv.org/">OpenCV</a> to detect people in
the grid, estimate the position of their feet in the 2d (top-down) grid via
projective transforms, assign each person a unique number and keep track of
them for as long as they remain in the grid. This is probably going to be one
of the more challenging components to write! It passes this data back to the
Control process and the Patterns via a proxied dict through a multiprocessing
Manager&nbsp;object.</p>
<p>Patterns and Sinks are similar. Both have their own package for all the pattern
or sink files, a top level class to inherit from, and register themselves with
the system using a decorator. For Patterns, the decorator also allows a
configuration to be registered, so that for example the maze pattern can offer
one- ...</p>
                    <a class="btn btn-default btn-xs" href="http://www.thegrid.fish/2014/07/12/control-software">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/11/testing-led-strips-and-a-psu">Testing <span class="caps">LED</span> strips and a <span class="caps">PSU</span></a></h2>
                <div class="summary"><p>I received a lot of parcels today!  The LEDs, thermal compound, some relays,
and what we have affectionately termed The Danger&nbsp;Cable:</p>
<p><img alt="schematic" src="/images/danger_cable.jpg" /></p>
<p>At first we weren&#8217;t convinced the <span class="caps">LED</span> strips would be bright enough.  A quick
test in the garden cleared any doubts about the&nbsp;brightness:</p>
<p><img alt="lightsabre" src="/images/lightsabre.jpg" /></p>
<p>Finally, I finished putting the power supply back together after a good clean
and a fresh dab of thermal grease.  After a little sanity testing, we thought
we&#8217;d give it some&nbsp;load:</p>
<p><img alt="power supply testing" src="/images/psu_test.jpg" /></p>
<p>The power supply seems to work beautifully, although it was only pushing 4A out
of its rated&nbsp;30A!</p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/10/rework-and-a-pcb">Rework and a <span class="caps">PCB</span></a></h2>
                <div class="summary"><p>Having made surprisingly short work of reworking the first power supply, a blob
of epoxy sealed the deal.  Testing will have to wait until we get a few more
parts, but it looks&nbsp;good.</p>
<p>We had a number of interesting ideas for making the electronics easier.
Instead of using an Arduino to talk over <span class="caps">USB</span> and drive the shift registers (and
have yet another layer of software in the stack), it turns out you can use
several of the pins on an <span class="caps">FTDI</span> ft232r as GPIOs and use it to drive shift
registers&nbsp;directly.</p>
<p>Later in the evening, I was making a quick stripboard prototype with a shift
register and some PMOSes and complaining bitterly to Adam about cutting
stripboard tracks.  We shortly decided that it was, in fact, a rather good idea
to make a <span class="caps">PCB</span>.  Instead of one massive <span class="caps">PCB</span>, we could break it down to 7 PCBs,
each with a shift register and 7 outputs.  We can cascade the boards&#8217; shift
registers and connect each board directly to a power supply.  Surprisingly
quickly, the schematic looked something like&nbsp;this: </p>
<p><img alt="schematic" src="/images/pcb_schematic.png" /></p>
<p>This all just about barely fits on a 5cm x 5cm <span class="caps">PCB</span>: (surface mount resistors
omitted for clarity, but they look like they&#8217;d&nbsp;fit&#8230;)</p>
<p><img alt="pcb_55" src="/images/pcb_55.png" /></p>
<p>Using a 10cm x 5cm board, everything gets a lot more comfortable, a looks a
little&nbsp;like:</p>
<p><img alt="pcb_long" src="/images/pcb_long.png" /></p>
<p>As a bonus, with the PCBs all lined up the LEDs will look something like a
grid.  In the end we went back to using through-hole components for everything.
Surface mount resistors would be smaller and cheaper, but through-hole is a lot
more&nbsp;fun.</p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/09/aluminium-arrived-at-last">Aluminium Arrived (at&nbsp;last)</a></h2>
                <div class="summary"><p>After some more wrangling with the online vehicle tracking, we eventually had a
firm <span class="caps">ETA</span>&#8230; in the past. It slipped slowly further back in time until the
estimated delivery was an hour&nbsp;ago.</p>
<p><img alt="delivery tracking..." src="/images/eta_the_past.png" /></p>
<p>Luckily the aluminium did eventually make it to the present time and we happily
took&nbsp;delivery.</p>
<p><img alt="aluminium in the garden" src="/images/alu_in_garden.jpg" /></p>
<p>A few hours of hard sawing, filing and taping up later, and we now have eight
bundles of aluminium angle, all ready to be used for the structural component
of&nbsp;TheGrid.</p>
<p><img alt="adam sawing" src="/images/adam_sawing.jpg" /></p>
<p>We also opened up one of the power supplies to investigate the design and
quality. True to the &#8220;Professional&#8221; sticker on the box, the insides included a
large toroid that had torn free of its soldering, so we&#8217;ll probably need to do
a little rework before these are&nbsp;shipshape.</p>
<p><img alt="i'm sure this PSU is just fine" src="/images/psu_dodgy_transformer.jpg" /></p>
<p>The rest of the prototype electronics have also arrived, so we&#8217;re ready to
start testing the control electronics. Hopefully the first LEDs (to verify
colour choice) will be arriving tomorrow so we can light something&nbsp;up!</p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/08/psus-arrived-aluminium-didnt">PSUs arrived (aluminium&nbsp;didn&#8217;t)</a></h2>
                <div class="summary"><p>Five of the most legitimate 30A 12V PSUs you can find on eBay arrived today:
<img alt="PSUs arrived" src="/images/psus_arrived.jpg" /></p>
<p>Unfortunately the aluminium couldn&#8217;t be delivered today so fingers crossed
we&#8217;ll get it&nbsp;tomorrow.</p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/07/another-day-another-order">Another day, another&nbsp;order</a></h2>
                <div class="summary"><p>So, yet more exciting things are on the way, this time in the form of two
sample rolls of <span class="caps">LED</span> strip.  We couldn&#8217;t decide whether &#8220;Pure/Day White&#8221; or
&#8220;Cool White&#8221; sounded more appropriate, so we&#8217;re going to check out&nbsp;both.</p>
<p>In other news, the electronics design is significantly taking shape.  After a
number of iterations and a lot of discussion, we decided we want high-side
driving of the <span class="caps">LED</span> strip, and therefore P-channel <span class="caps">MOSFET</span> drivers.  This
would&#8217;ve required another row of transistors to interface between our shift
registers and the MOSFETs, except for Matt&#8217;s (thanks!) neat idea of using shift
registers with open-drain drivers.  Prototype parts <span class="caps">ETA</span> tomorrow, so we&#8217;ll see
how the idea stands up to&nbsp;testing.</p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/06/175m-aluminium-angle-on-its-way">175m Aluminium Angle on its&nbsp;way&#8230;</a></h2>
                <div class="summary"><p>This is all feeling much more real now as we&#8217;ve just placed the order for 35 5m
lengths of aluminium equal angle. It should arrive Tuesday, apparently! I can
only imagine how confused the delivery driver will be when the address is a
residental&nbsp;house.</p>
<p><img alt="the order" src="/images/alu_order.png" /></p>
<p>We&#8217;ve now also finished the prototype design for the control electronics and
ordered a few samples to test drive. Hopefully we&#8217;ll have flashing LEDs by the
end of the&nbsp;week.</p>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="http://www.thegrid.fish/2014/07/05/approval">Approval!</a></h2>
                <div class="summary"><p>We got approval!  We&#8217;ve been waiting for the <span class="caps">EMF</span> committee to get back to us
about our proposal, and, they did &#8212; The·Grid at <span class="caps">EMF2014</span> is&nbsp;happening!</p>
<p>To celebrate, I bought £70 worth of 12V PSUs (150A worth) and we set up this&nbsp;website.</p>
                </div>
            </article>
            <hr/>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item"><a href="https://twitter.com/__thegrid"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
                  </ul>
                </li>



                <li class="list-group-item"><a href="http://www.thegrid.fish/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group " id="tags">
                        <li class="list-group-item tag-1">
                            <a href="http://www.thegrid.fish/tag/power.html">
                                power
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="http://www.thegrid.fish/tag/electronics.html">
                                electronics
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://www.thegrid.fish/tag/leds.html">
                                LEDs
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://www.thegrid.fish/tag/software.html">
                                software
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://www.thegrid.fish/tag/structures.html">
                                structures
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://www.thegrid.fish/tag/testing.html">
                                testing
                            </a>
                        </li>
                    </ul>
                </li>    
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://emfcamp.org" target="_blank">
                EMF 2014
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Dr House Industries
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://www.thegrid.fish/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://www.thegrid.fish/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://www.thegrid.fish/theme/js/respond.min.js"></script>

</body>
</html>